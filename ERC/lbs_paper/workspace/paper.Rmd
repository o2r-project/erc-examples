---
title: "A mobile assistant for indoor kiosk systems based on self-localization and QR codes"
author: 
- affiliation:  "Institute for Science"
  name: "Anna Anonymous"
licenses:
  code: CC-BY-3.0
  data: CC-BY-3.0
  text: CC-BY-3.0
date: "15 May 2020"
output: html_document
abstract: "Because outdoor navigation systems are used frequently, people are accustomed to automatic and accurate localization. To achieve the same inside buildings, extensive infrastructure is needed, which is either cost- or labour-intensive. An alternative approach is to involve users in the localization process, for example, by asking them to scan QR codes for which the location within the building is stored in a database. In this work, we present a concept for creating indoor navigation systems to assist first-time visitors in navigating public buildings based on stepwise self-localization. Based on this concept, we designed and implemented two prototypes: a mixed approach combining a stationary kiosk system with a smartphone application and a stand-alone mobile application. We evaluated the two prototypes separately against an existing stationary kiosk display concerning efficiency, workload, and user acceptance. The results provide initial evidence that the participants favoured the two prototypes over the kiosk display while also revealing several limitations that should be addressed in a next iteration. We also showed that based on a common infrastructure it is possible to test different implementations independently."
---

```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
studyA_participants <- read.csv(file="studyA_participants.csv", header=TRUE, sep=";")
studyB_participants <- read.csv(file="studyB_participants.csv", header=TRUE, sep=";")
studyA_results <- read.csv(file="studyA_results.csv", header=TRUE, sep=",")
studyB_results <- read.csv(file="studyB_results.csv", header=TRUE, sep=";")
```

The two user studies were conducted separately by the developers of the prototypes. 
In study A, participants had to reach two targets, one by using the existing kiosk display, the second one with the help of the mixed approach consisting of a newly implemented kiosk system and a mobile application.
In study B, participants had to reach the same two targets, one with the help of the existing kiosk display and the second one by using the stand-alone mobile application.


```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
recodeSantaBarbara <- function(values) {
  x = c()
  for (i in values) {
    x = append(x, c(switch(i,7,6,5,4,3,2,1)))
  }
  return (x)
}

getSenseOfDirectionForPerson <- function(index, dataset) {
  sum = recodeSantaBarbara(dataset$SBSOD1)[index] + dataset$SBSOD2[index] + recodeSantaBarbara(dataset$SBSOD3)[index] + 
    recodeSantaBarbara(dataset$SBSOD4)[index] + recodeSantaBarbara(dataset$SBSOD5)[index] + dataset$SBSOD6[index] + 
    recodeSantaBarbara(dataset$SBSOD7)[index] + dataset$SBSOD8[index] + recodeSantaBarbara(dataset$SBSOD9)[index] + dataset$SBSOD10[index] + dataset$SBSOD11[index] + dataset$SBSOD12[index] + dataset$SBSOD13[index] + recodeSantaBarbara(dataset$SBSOD14)[index] + dataset$SBSOD15[index] 
  return (sum/15)
}

getAllSenseOfDir = function(dataset) {
  x = c()
  for (i in 1:length(dataset[,7])) {
    x = append(x, c(getSenseOfDirectionForPerson(i,dataset)))
  }
  return(x)
}

```

```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
getAverageValue = function(dataset, column) {
  persons = length(dataset[,column])
  sum = 0
  for (i in 1:persons) {
    sum = sum + dataset[,column][i]
  }
  return(sum/persons)
}
```

## Study A

```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
getAllSenseOfDir(studyA_participants)
options(digits=1)
```
### Participants
We recruited `r nrow(studyA_participants)` participants (`r sum(studyA_participants$gender == "f")` female, `r sum(studyA_participants$gender == "m")` male) aged between `r min(summary(studyA_participants$age))` and `r max(summary(studyA_participants$age))` years (mean age = `r mean(studyA_participants$age)` years) by contacting them personally in front of an adjacent building.
The participants had a background in economics (`r sum(studyA_participants$background == "economics")` participants), natural sciences (`r sum(studyA_participants$background == "natural")`), medicine (`r sum(studyA_participants$background == "medicine")`), social sciences (`r sum(studyA_participants$background == "social")`), law (`r sum(studyA_participants$background == "law")`), and didactic (`r sum(studyA_participants$background == "didactic")`).
None of them had visited the building before the study was conducted.
The average SBSOD score was `r mean(getAllSenseOfDir(studyA_participants))` with values ranging from `r min(getAllSenseOfDir(studyA_participants))` to `r max(getAllSenseOfDir(studyA_participants))`.
Participants indicated that they find it easy to use smartphones (mean score = `r mean(studyA_participants$smartphone_usage)`), cope well with new mobile apps (mean score = `r mean(studyA_participants$apps)`), and tend to become lost in large buildings (mean score = `r mean(studyA_participants$becoming_lost)`).
From the `r nrow(studyA_participants)` participants, `r sum(studyA_participants$usage_navsys_freq == "weekly")` use navigation systems weekly, `r sum(studyA_participants$usage_navsys_freq == "less than once a week")` less than weekly, `r sum(studyA_participants$usage_navsys_freq == "less than once a month")` less than monthly, and `r sum(studyA_participants$usage_navsys_freq == "only in exception / emergency")` only in exceptional cases.
None of them had ever used an indoor navigation system before and `r sum(studyA_participants$familiar_qrcodes == "yes")` were familiar with using QR codes whereas `r sum(studyA_participants$familiar_qrcodes == "no")` were not.

### Results 
```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
options(digits=2)
studyA_results$nasa_mean <- rowMeans(studyA_results[3:8])

times <- c("interaction_time", "navigation_time")
studyA_times_kiosk <- studyA_results[1:17, times]
studyA_times_mixed <- studyA_results[18:34, times]

nasa <- c("mental", "physical", "temporal", "performance", "effort", "frustration", "nasa_mean")
studyA_nasa_kiosk <- studyA_results[1:17, nasa]
studyA_nasa_mixed <- studyA_results[18:34, nasa]
```

While all participants found the target using the mobile application, one forgot the room number and thus failed when using the existing kiosk system. 

#### Times
To obtain route directions to the given target, participants on average spent `r mean(studyA_times_kiosk$interaction_time)` seconds to interact with the existing kiosk system (values ranged from `r min(studyA_times_kiosk$interaction_time)` to `r max(studyA_times_kiosk$interaction_time)` sec.) and `r mean(studyA_times_mixed$interaction_time)` sec. to interact with the newly implemented application (values ranged from `r min(studyA_times_mixed$interaction_time)` to `r max(studyA_times_mixed$interaction_time)` sec.).
For the subsequent navigation to the target, participants needed `r mean(studyA_times_kiosk$navigation_time)` sec. to find the target when using the kiosk system (values ranged from `r min(studyA_times_kiosk$navigation_time)` to `r max(studyA_times_kiosk$navigation_time)` sec.) and `r mean(studyA_times_mixed$navigation_time)` sec. with the help of the mobile application (values ranged from `r min(studyA_times_mixed$navigation_time)` to `r max(studyA_times_mixed$navigation_time)` sec.).

#### NASA TLX
The average NASA TLX score for the kiosk system was `r mean(studyA_nasa_kiosk$nasa_mean)` (values ranged from `r min(studyA_nasa_kiosk$nasa_mean)` to `r max(studyA_nasa_kiosk$nasa_mean)`) and `r mean(studyA_nasa_mixed$nasa_mean)` for the mobile application (values ranged from `r min(studyA_nasa_mixed$nasa_mean)` to `r max(studyA_nasa_mixed$nasa_mean)`).
The largest differences exist for mental demand in favour of the mobile application and temporal demand in favour of the kiosk system. 
The differences of the remaining scales are marginal: 
The kiosk system achieved better ratings with respect to the participants' performance and invested effort. 
In contrast, they required less physical demand and were less frustrated when using the mobile application.

```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
library(ggplot2)
library(scales)
library(dplyr)
library(tidyr)

size = 4.5

rowsKiosk = 1:17
rowsMixed = 18:34
df <- data.frame(System = c("kiosk", "mixed"),
                 mental = c(mean(studyA_results[rowsKiosk,]$mental), mean(studyA_results[rowsMixed,]$mental)),
                 physical = c(mean(studyA_results[rowsKiosk,]$physical), mean(studyA_results[rowsMixed,]$physical)),
                 temporal = c(mean(studyA_results[rowsKiosk,]$temporal), mean(studyA_results[rowsMixed,]$temporal)),
                 performance = c(mean(studyA_results[rowsKiosk,]$performance), mean(studyA_results[rowsMixed,]$performance)),
                 effort = c(mean(studyA_results[rowsKiosk,]$effort), mean(studyA_results[rowsMixed,]$effort)),
                 frustration = c(mean(studyA_results[rowsKiosk,]$frustration), mean(studyA_results[rowsMixed,]$frustration)))
DFtall <- df %>% gather(key = NasaTLX, value = Score, mental:frustration)

png(file="studyA_nasa.png")
ggplot(DFtall, aes(NasaTLX, Score, fill = System)) + 
  geom_col(position = "dodge") +
  geom_text(aes(label = round(Score, 1)), position = position_dodge(width = 1), vjust = 1.5, hjust = 0.5, size = size) +
  coord_cartesian(ylim = c(1, 20)) +
  theme(text = element_text(size=20), axis.text.x = element_text(angle=90, hjust=1), legend.position = c(0.9, 0.8)) 
dev.off()            
```

#### User Acceptance (1 = do not agree at all, 5 = fully agree ) 
```{r, echo=FALSE, message=FALSE, comment=FALSE, warning=FALSE}
rowsKiosk = 1:17
rowsMixed = 18:34
df <- data.frame(group = c("kiosk", "mixed"),
                 ease_of_use = c(mean(studyA_results[rowsKiosk,]$easeofuse), mean(studyA_results[rowsMixed,]$easeofuse)),
                 understanding = c(mean(studyA_results[rowsKiosk,]$understanding), mean(studyA_results[rowsMixed,]$understanding)),
                 guidance = c(mean(studyA_results[rowsKiosk,]$guidance), mean(studyA_results[rowsMixed,]$guidance)),
                 reliability = c(mean(studyA_results[rowsKiosk,]$relicability), mean(studyA_results[rowsMixed,]$relicability)),
                 orientation = c(mean(studyA_results[rowsKiosk,]$orientation), mean(studyA_results[rowsMixed,]$orientation)),
                 recommend = c(mean(studyA_results[rowsKiosk,]$recommendation), mean(studyA_results[rowsMixed,]$recommendation)),
                 applicability = c(mean(studyA_results[rowsKiosk,]$applicability), mean(studyA_results[rowsMixed,]$applicability)))
DFtall <- df %>% gather(key = Usability, value = Score, ease_of_use:applicability)

png(file="studyA_use.png")
ggplot(DFtall, aes(Usability, Score, fill = group)) + 
  geom_col(position = "dodge") +
  geom_text(aes(label = round(Score, 1)), position = position_dodge(width = 1), vjust = 1.5, hjust = 0.5, size = size) +
  coord_cartesian(ylim = c(1, 5)) + 
  theme(text = element_text(size=20), axis.text.x = element_text(angle=90, hjust=1), legend.position = "none") 
dev.off()
```


## Study B
```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
options(digits=1)
getAllSenseOfDir(studyB_results)
```

### Participants
By contacting potential candidates personally in front of a neighboring building, we collected `r nrow(studyB_participants)` participants (`r sum(studyB_participants$gender == "f")` female, `r sum(studyB_participants$gender == "m")` male) aged between `r min(studyB_participants$age)` and `r max(studyB_participants$age)` (mean age = `r mean(studyB_participants$age)`). 
The participants had a background in economics (`r sum(studyB_participants$background == "economics")`), social sciences (`r sum(studyB_participants$background == "social")` participants), natural sciences (`r sum(studyB_participants$background == "natural")`), medicine (`r sum(studyB_participants$background == "medicine")`), didactic (`r sum(studyB_participants$background == "didactic")`), and law (`r sum(studyB_participants$background == "law")`). 
From the `r nrow(studyB_participants)` participants, `r sum(studyB_participants$building_familiarity == 1)` had not visited the building before we carried out the study. 
The remaining `r sum(studyB_participants$building_familiarity == 2)` had visited the building before but indicated that they were unfamiliar with the building.
The average SBSOD score was `r mean(getAllSenseOfDir(studyB_participants))` with values ranging from `r min(getAllSenseOfDir(studyB_participants))` to `r max(getAllSenseOfDir(studyB_participants))`.
Participants indicated that they find it easy to use smartphones (mean score = `r mean(studyB_participants$smartphone_usage)`), cope well with new mobile apps (mean score = `r mean(studyB_participants$apps)`), and tend to become lost in large buildings (mean score = `r mean(studyB_participants$becoming_lost)`).
From the `r nrow(studyB_participants)` participants, `r sum(studyB_participants$usage_navsys_freq == "weekly")` use navigation systems weekly, `r sum(studyB_participants$usage_navsys_freq == "less than once a week")` less than weekly, and `r sum(studyB_participants$usage_navsys_freq == "only in exception / emergency")` only in exceptional cases.
`r sum(studyB_participants$used_indoor_nav == "yes")` participants had used an indoor navigation system before, and `r sum(studyB_participants$familiar_qrcodes == "yes")` were familiar with using QR codes.

```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
options(digits=0)
```

```{r, echo=FALSE, results="hide", message=FALSE, comment=FALSE, warning=FALSE}
options(digits=2)
studyB_results$nasa_mean <- rowMeans(studyB_results[3:8])

times <- c("interaction_time", "navigation_time")
studyB_times_kiosk <- studyB_results[1:14, times]
studyB_times_app <- studyB_results[15:28, times]

nasa <- c("mental", "physical", "temporal", "performance", "effort", "frustration", "nasa_mean")
studyB_nasa_kiosk <- studyB_results[1:14, nasa]
studyB_nasa_app <- studyB_results[15:28, nasa]
```


### Results
In total, four participants failed to find the target. 
Two of them failed while using the mobile app, because they did not use the ``Next Step"-button and thus lost orientation. 
From the kiosk users who failed, one could not memorize the route instruction, and the other one selected the wrong room.  

#### Times
On average, the participants needed `r mean(studyB_times_kiosk$interaction_time)` sec. to interact with the kiosk system (values ranged from `r min(studyB_times_kiosk$interaction_time)` to `r max(studyB_times_kiosk$interaction_time)` sec.) and `r mean(studyB_times_app$interaction_time)` sec. (values ranged from `r min(studyB_times_app$interaction_time)` to `r max(studyB_times_app$interaction_time)` sec.) with the mobile app. 
They needed `r mean(studyB_times_kiosk$navigation_time)` sec. for the navigation using the kiosk system (values ranged from `r min(studyB_times_kiosk$navigation_time)` to `r max(studyB_times_kiosk$navigation_time)` sec.) and `r mean(studyB_times_app$navigation_time)` sec. using the mobile app (values ranged from `r min(studyB_times_app$navigation_time)` to `r max(studyB_times_app$navigation_time)` sec.). 

#### NASA TLX
The average NASA TLX score was the same for both systems (`r mean(studyB_nasa_kiosk$nasa_mean)`) with values ranging from `r min(studyB_nasa_kiosk$nasa_mean)` to `r max(studyB_nasa_kiosk$nasa_mean)` for the kiosk display and `r min(studyB_nasa_app$nasa_mean)` to `r max(studyB_nasa_app$nasa_mean)` for the mobile app.
The largest differences can be found regarding physical effort and frustration in favour of the kiosk system as well as mental effort in favour of the mobile app.
Minor differences exist with respect to effort as well as temporal demand in favour of the mobile app and performance in favour of the kiosk display.

```{r, echo=FALSE, message=FALSE, comment=FALSE, warning=FALSE}
rowsKiosk = 1:14
rowsMixed = 15:28
df <- data.frame(System = c("kiosk", "mixed"),
                 mental = c(mean(studyB_results[rowsKiosk,]$mental), mean(studyB_results[rowsMixed,]$mental)),
                 physical = c(mean(studyB_results[rowsKiosk,]$physical), mean(studyB_results[rowsMixed,]$physical)),
                 temporal = c(mean(studyB_results[rowsKiosk,]$temporal), mean(studyB_results[rowsMixed,]$temporal)),
                 performance = c(mean(studyB_results[rowsKiosk,]$performance), mean(studyB_results[rowsMixed,]$performance)),
                 effort = c(mean(studyB_results[rowsKiosk,]$effort), mean(studyB_results[rowsMixed,]$effort)),
                 frustration = c(mean(studyB_results[rowsKiosk,]$frustration), mean(studyB_results[rowsMixed,]$frustration)))
DFtall <- df %>% gather(key = NasaTLX, value = Score, mental:frustration)

png(file="studyB_nasa.png")
ggplot(DFtall, aes(NasaTLX, Score, fill = System)) + 
  geom_col(position = "dodge") +
  geom_text(aes(label = round(Score, 1)), position = position_dodge(width = 1), vjust = 1.5, hjust = 0.5, size = size) +
  coord_cartesian(ylim = c(1, 20)) +
  theme(text = element_text(size=20), axis.text.x = element_text(angle=90, hjust=1), legend.position = c(0.9, 0.8)) 
dev.off()            
```

#### User Acceptance (1 = do not agree at all, 5 = fully agree ) 
```{r, echo=FALSE, message=FALSE, comment=FALSE, warning=FALSE}
rowsKiosk = 1:14
rowsMixed = 15:28
df <- data.frame(group = c("kiosk", "app"),
                 ease_of_use = c(mean(studyB_results[rowsKiosk,]$easeofuse), mean(studyB_results[rowsMixed,]$easeofuse)),
                 understanding = c(mean(studyB_results[rowsKiosk,]$understanding), mean(studyB_results[rowsMixed,]$understanding)),
                 guidance = c(mean(studyB_results[rowsKiosk,]$guidance), mean(studyB_results[rowsMixed,]$guidance)),
                 reliability = c(mean(studyB_results[rowsKiosk,]$relicability), mean(studyB_results[rowsMixed,]$relicability)),
                 orientation = c(mean(studyB_results[rowsKiosk,]$orientation), mean(studyB_results[rowsMixed,]$orientation)),
                 recommend = c(mean(studyB_results[rowsKiosk,]$recommendation), mean(studyB_results[rowsMixed,]$recommendation)),
                 applicability = c(mean(studyB_results[rowsKiosk,]$applicability), mean(studyB_results[rowsMixed,]$applicability)))
DFtall <- df %>% gather(key = Usability, value = Score, ease_of_use:applicability)

png(file="studyB_use.png")
ggplot(DFtall, aes(Usability, Score, fill = group)) + 
  geom_col(position = "dodge") +
  scale_y_continuous(breaks = c(1:5), labels = c("1", "2", "3", "4", "5")) +
  geom_text(aes(label = round(Score, 1)), position = position_dodge(width = 1), vjust = 1.5, hjust = 0.5, size = size) +
  coord_cartesian(ylim = c(1, 5)) +
  theme(text = element_text(size=20), axis.text.x = element_text(angle=90, hjust=1), legend.position = "none")  
dev.off()
```



